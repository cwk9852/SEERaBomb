mapCancs<-function(D){
  ICD9=D$ICD9
#   histo2=D$histo2
  histo3=D$histo3
  cancer=rep("other",dim(D)[1])
#   cancer[(ICD9<1450)]="l140"
  cancer[(ICD9>2010)]="otherCIS"
  cancer[(ICD9==2330)]="breastCIS"
#   cancer[(ICD9==2331)]="cervixCIS"
  cancer[(ICD9>=1400)&(ICD9<=1490)]="oral"
  cancer[(ICD9>=1500)&(ICD9<=1509)]="esophagus"
  cancer[(ICD9>=1510)&(ICD9<=1519)]="stomach"
  cancer[(ICD9>=1530)&(ICD9<=1539)]="colon"
  cancer[(ICD9>=1540)&(ICD9<=1549)]="rectal"
  cancer[(ICD9>=1550)&(ICD9<=1559)]="liver"
  cancer[(ICD9>=1570)&(ICD9<=1579)]="pancreas"
  cancer[(ICD9>=1590)&(ICD9<=1599)]="GI"
  cancer[(ICD9>=1610)&(ICD9<=1619)]="larynx"
  cancer[(ICD9>=1620)&(ICD9<=1629)]="lung"
  cancer[(ICD9>=1710)&(ICD9<=1719)]="HnN"
  cancer[(ICD9>=1720)&(ICD9<=1729)]="melanoma"
  cancer[(ICD9>=1730)&(ICD9<=1739)]="skin"
  cancer[(ICD9>=1740)&(ICD9<=1749)]="breast"
  cancer[(ICD9==175)|((ICD9>=1750)&(ICD9<=1759))]="breast"
  cancer[ICD9==179]="uterus"
  cancer[(ICD9>=1800)&(ICD9<=1809)]="cervix"
#   cancer[ICD9==181]="pla"
  cancer[(ICD9>=1820)&(ICD9<=1829)]="uterus"
  cancer[(ICD9>=1830)&(ICD9<=1839)]="ovary"
  cancer[ICD9==185]="prostate"
  cancer[(ICD9>=1860)&(ICD9<=1869)]="testes"
  cancer[(ICD9>=1880)&(ICD9<=1889)]="bladder"
  cancer[(ICD9>=1890)&(ICD9<=1899)]="renal"
  cancer[(ICD9>=1900)&(ICD9<=1909)]="eye"
  cancer[(ICD9>=1910)&(ICD9<=1919)]="brain"
  cancer[ICD9==193]="thyroid"
  cancer[(ICD9>=2000)&(ICD9<2010)]="NHL"
  cancer[(ICD9>=2010)&(ICD9<2020)]="hodgkin"
  cancer[(ICD9>=2020)&(ICD9<2030)]="NHL"
  cancer[(ICD9>=2030)&(ICD9<2040)]="MM"
  cancer[ICD9==2040]="ALL"
  cancer[ICD9==2041]="CLL"
  cancer[(ICD9==2050)|(ICD9==2080)]="AML"
  cancer[(histo3==9866)]="APL" # this will overwrite AMLs above and thus keep them exclusive
  cancer[(histo3>9979)&(histo3<9990)]="MDS"
  cancer[(histo3==9945)]="CMML"
#   cancer[(histo2==9863)]="CML"
  cancer[histo3%in%c(9863,9875,9876)]="CML"
  D$cancer=as.factor(cancer)
  D
}  
